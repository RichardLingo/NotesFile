---
title: 处理稀疏矩阵
authors: Ethan Lin
year: 2024-12-06
tags:
  - 类型/AI问答笔记
  - 日期/2024-12-06
  - 内容/处理数据
  - 内容/稀疏矩阵
  - 内容/PyTorch
  - 内容/Numpy
  - 内容/JAX
aliases:
  - 处理稀疏矩阵
---
# 处理稀疏矩阵




> [!attention]
> 以下由AI回答，不保证正确性！






以下是 **PyTorch**、**JAX** 和 **Numpy (通过 Scipy)** 在稀疏矩阵操作方面的详细对比表，包括示例代码，展示初始化、切片获取值、切片赋值、加减法、乘除法、求和、稀疏和稠密转换的操作方式。

------

### **稀疏矩阵操作对比表**

| **操作**          | **PyTorch**                                                  | **JAX**                                                      | **Numpy (Scipy)**                                            |
| ----------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **1. 初始化**     | `python import torch indices = torch.tensor([[0, 1], [2, 3]]) values = torch.tensor([3, 4]) sparse_matrix = torch.sparse_coo_tensor(indices, values, (4, 4)) ` | `python import jax.numpy as jnp from jax.experimental.sparse import BCOO indices = jnp.array([[0, 1], [2, 3]]) values = jnp.array([3, 4]) sparse_matrix = BCOO((values, indices), shape=(4, 4)) ` | `python from scipy.sparse import coo_matrix import numpy as np row = np.array([0, 1]) col = np.array([2, 3]) data = np.array([3, 4]) sparse_matrix = coo_matrix((data, (row, col)), shape=(4, 4)) ` |
| **2. 切片获取值** | `python dense_matrix = sparse_matrix.to_dense() value = dense_matrix[0, 2] ` | `python dense_matrix = sparse_matrix.todense() value = dense_matrix[0, 2] ` | `python dense_matrix = sparse_matrix.toarray() value = dense_matrix[0, 2] ` |
| **3. 切片赋值**   | 不直接支持稀疏矩阵赋值，需转为稠密： `python dense_matrix = sparse_matrix.to_dense() dense_matrix[0, 2] = 5 sparse_matrix = torch.sparse_coo_tensor(indices, dense_matrix.nonzero(as_tuple=True), (4, 4)) ` | 不直接支持稀疏矩阵赋值，需转为稠密： `python dense_matrix = sparse_matrix.todense() dense_matrix = dense_matrix.at[0, 2].set(5) sparse_matrix = BCOO.fromdense(dense_matrix) ` | 不直接支持稀疏矩阵赋值，需转为稠密： `python dense_matrix = sparse_matrix.toarray() dense_matrix[0, 2] = 5 sparse_matrix = coo_matrix(dense_matrix) ` |
| **4. 加法**       | `python result = sparse_matrix + other_sparse_matrix `       | `python result = sparse_matrix + other_sparse_matrix `       | `python result = sparse_matrix + other_sparse_matrix `       |
| **5. 乘法**       | `python result = torch.sparse.mm(sparse_matrix, dense_matrix) ` | `python result = sparse_matrix @ dense_matrix `              | `python result = sparse_matrix.dot(dense_matrix) `           |
| **6. 除法**       | 不支持直接稀疏操作，需转稠密后再计算。                       | 不支持直接稀疏操作，需转稠密后再计算。                       | 不支持直接稀疏操作，需转稠密后再计算。                       |
| **7. 求和**       | `python total = sparse_matrix.to_dense().sum() `             | `python total = sparse_matrix.todense().sum() `              | `python total = sparse_matrix.sum() `                        |
| **8. 稀疏转稠密** | `python dense_matrix = sparse_matrix.to_dense() `            | `python dense_matrix = sparse_matrix.todense() `             | `python dense_matrix = sparse_matrix.toarray() `             |
| **9. 稠密转稀疏** | `python sparse_matrix = torch.sparse_coo_tensor(dense_matrix.nonzero(), dense_matrix[dense_matrix.nonzero()], dense_matrix.shape) ` | `python sparse_matrix = BCOO.fromdense(dense_matrix) `       | `python sparse_matrix = coo_matrix(dense_matrix) `           |

------

### **总结说明**

1. **PyTorch** 和 **JAX** 在操作稀疏矩阵时，API 非常相似，但稀疏切片操作和赋值需要转为稠密矩阵操作后重建稀疏矩阵。
2. **Numpy + Scipy** 提供了经典的稀疏矩阵功能，但更适用于传统科学计算场景，不支持直接硬件加速。
3. **硬件加速**：PyTorch 和 JAX 支持 GPU 运算，但稀疏矩阵的硬件加速性能尚未完全优化。
4. **除法操作**：三者均不直接支持稀疏矩阵上的逐元素除法，需转为稠密矩阵后计算。

------

需要根据场景选择合适的工具。如果硬件加速需求高且需处理稀疏矩阵，推荐 JAX 或 PyTorch；如果主要是科学计算，推荐 Numpy + Scipy。
